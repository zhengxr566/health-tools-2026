{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-10 col-lg-8">

    <div class="bg-white rounded-3 shadow-sm p-4 mb-3">
      <h1 class="h4 mb-1">BMI 计算器（高级版）</h1>
      <p class="text-muted mb-0">除了 BMI 数值，还提供健康体重区间、可视化与行动建议（仅供参考）。</p>
    </div>

    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <form method="post" class="row g-3">
          <div class="col-md-6">
            <label class="form-label">身高（cm）</label>
            <input name="height_cm" class="form-control" inputmode="decimal" required value="{{ height_cm_in }}">
          </div>
          <div class="col-md-6">
            <label class="form-label">体重（kg）</label>
            <input name="weight_kg" class="form-control" inputmode="decimal" required value="{{ weight_kg_in }}">
          </div>
          <div class="col-12">
            <button class="btn btn-success w-100">计算</button>
          </div>
        </form>

        {% if error %}
          <div class="alert alert-warning mt-3 mb-0">{{ error }}</div>
        {% endif %}
      </div>
    </div>

    {% if bmi is not none %}
      <div class="card shadow-sm mb-3">
        <div class="card-body">
          <div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
            <div>
              <div class="text-muted small">你的 BMI</div>
              <div class="h3 mb-0">{{ bmi }}</div>
            </div>
            <div>
              <span class="badge text-bg-primary p-2">{{ category }}</span>
            </div>
          </div>

          <div class="mt-3">
            <div class="d-flex justify-content-between small text-muted">
              <span>偏低</span><span>中间</span><span>偏高</span>
            </div>
            <div class="progress" role="progressbar" aria-label="BMI gauge" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100">
              <div class="progress-bar" style="width: {{ progress }}%"></div>
            </div>
            <div class="form-text">提示：此条仅作直观展示（将 BMI 映射到 15–35 的范围）。</div>
          </div>

          <hr class="my-4">

          <h2 class="h6 mb-2">健康体重区间（按 BMI 18.5–23.9）</h2>
          <div class="bg-light rounded-3 p-3">
            <div>建议体重范围：<b>{{ ideal_min }} – {{ ideal_max }} kg</b></div>

            {% if to_min is not none and to_max is not none %}
              <div class="small text-muted mt-2">
                {% if bmi < 18.5 %}
                  距离进入“正常”下限还差约 <b>{{ to_min|abs }}</b> kg（仅供参考）。
                {% elif bmi > 23.9 %}
                  距离回到“正常”上限约需减少 <b>{{ to_max }}</b> kg（仅供参考）。
                {% else %}
                  你目前在区间内，可重点关注体脂、腰围与体能。
                {% endif %}
              </div>
            {% endif %}
          </div>

          <hr class="my-4">

          <h2 class="h6 mb-2">{{ suggestion_title }}</h2>
          <ul class="mb-2">
            {% for s in suggestions %}
              <li>{{ s }}</li>
            {% endfor %}
          </ul>
          <div class="small text-muted">{{ risk_note }}</div>

          <div class="mt-3 d-flex flex-wrap gap-2">
            <a class="btn btn-outline-primary btn-sm" href="/bmr">去算 BMR（基础代谢）</a>
            <a class="btn btn-outline-primary btn-sm" href="/calorie">去算 TDEE（每日热量）</a>
            <a class="btn btn-outline-primary btn-sm" href="/bodyfat">去算 体脂率</a>
            <a class="btn btn-outline-primary btn-sm" href="/waist">看 腰围风险</a>
          </div>
        </div>
      </div>
    {% endif %}

    <!-- 说明内容（SEO） -->
    <div class="bg-white rounded-3 shadow-sm p-4">
      <h2 class="h6">什么是 BMI？</h2>
      <p class="text-muted">
        BMI（身体质量指数）是通过体重（kg）÷ 身高（m）的平方计算得出的常用指标，用于成人体重状况的粗略筛查。
        BMI 的优点是简单易算，适合快速判断“偏瘦/正常/偏胖/肥胖”等区间；但它并不等于体脂率，也无法反映肌肉量、骨量和脂肪分布。
      </p>

      <h2 class="h6 mt-4">BMI 正常范围是多少？</h2>
      <p class="text-muted">
        常见成人参考：&lt;18.5 偏瘦，18.5–23.9 正常，24.0–27.9 偏胖，≥28 肥胖。建议把 BMI 看作“起点”，
        再结合腰围、体脂率与体检指标综合评估。
      </p>

      <h2 class="h6 mt-4">如何用 BMI 做体重管理？</h2>
      <p class="text-muted">
        如果你希望减脂或控制体重，建议先计算每日热量需求（TDEE），再制定温和的热量缺口；同时保证足够蛋白质并加入力量训练，
        更有利于维持代谢与体型。若 BMI 正常，也可以用腰围/体脂率来判断是否需要改善体成分。
      </p>

      <h2 class="h6 mt-4">相关工具推荐</h2>
      <ul class="text-muted mb-0">
        <li><a href="/bmr">基础代谢（BMR）</a>：了解基础消耗</li>
        <li><a href="/calorie">每日热量需求（TDEE）</a>：制定目标热量</li>
        <li><a href="/bodyfat">体脂率计算</a> 与 <a href="/waist">腰围风险</a>：更接近体成分与脂肪分布</li>
      </ul>

      <hr class="my-4">
      <p class="small text-muted mb-0">免责声明：本页面与计算结果仅供参考，不构成医疗建议。如有疾病或不适请咨询专业人士。</p>
    </div>

  </div>
</div>
{% endblock %}
